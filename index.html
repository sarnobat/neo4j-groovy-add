<!DOCTYPE html>
<html>
<head>
<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"><script> -->

<script src="jquery/jquery-1.9.1.js"></script>
<script type="text/javascript" src="jquery/purl.js"></script>

<script>

		
var urlBase = "http://netgear.rohidekar.com:4447/yurl";
$(document).ready(function(){
var rootId = $.url().param('rootId')

if (rootId == null || rootId == '') {
	rootId = 0;
	alert('No root id specified');
}
$("#status").text("Loading")  			
  	$.getJSON(urlBase + "/keys",function(result){
      $.each(result, function(a,binding,c){
        $("#keys").append(binding.key + "=" + binding.name +" # node " + binding.id + "\n");
        $(window).keypress(function(event) {
        	if (binding.key == String.fromCharCode(event.which)) {
				var url = urlBase + "/relate?parentId=" +binding.id+"&childId=" +  $("#urls").children()[0].id;
				//alert(url);
				$.getJSON(url,function(result){
					if (result.status == 'SUCCESS') {
						$("#urls").children()[0].remove();
					}
				});
			}
			// we can't use the kb_shortcuts API because you can't keep the shift key held down in between keypresses
		});
      });
    });
    $.getJSON(urlBase + "/uncategorized?rootId=" +rootId,function(result){
      $("#status").text("Populating")
      $.each(result, function(resultRowNumber, field){
        $("#urls").append("<li id="+field.id+">[" + field.id + "]: "+ field.title + " (" + field.url + ") " + "</li>");
      });
	  $("#status").text("Done")
    });
});
</script>
</head>
<body>
Key bindings<br>
<textarea id="keys"></textarea>
<br><br>
<!--<button>get urls</button>-->
<div id="status">Init</div>
<ol id="urls"></ol>

</body>
</html>
